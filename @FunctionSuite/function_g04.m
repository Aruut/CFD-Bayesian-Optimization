function [y, valid] = function_g04(x)
%FUNCTION_G04  G04 test function, x is a row-wise list of vectors
%	From T. Runarsson et al. (2000)
%	Part of the FunctionSuite class

y = 5.3578547*x(:,3).^2 + ...
	0.8356891*x(:,1).*x(:,5) + ...
	37.293239*x(:,1) + ...
	-40792.141;

valid = not(any(isnan(y), 2));
g1valid = (85.334407 + 0.0056858*x(:,2).*x(:,5) + 0.0006262*x(:,1).*x(:,4) - 0.0022053*x(:,3).*x(:,5) - 92) <= 0;
g2valid = (-85.334407 - 0.0056858*x(:,2).*x(:,5) - 0.0006262*x(:,1).*x(:,4) + 0.0022053*x(:,3).*x(:,5)) <= 0;
g3valid = (80.51249 + 0.0071317*x(:,2).*x(:,5) + 0.0029955*x(:,1).*x(:,2) + 0.0021813*x(:,3).^2 - 110) <= 0;
g4valid = (-80.51249 - 0.0071317*x(:,2).*x(:,5) - 0.0029955*x(:,1).*x(:,2) - 0.0021813*x(:,3).^2 + 90) <= 0;
g5valid = (9.300961 + 0.0047026*x(:,3).*x(:,5) + 0.0012547*x(:,1).*x(:,3) + 0.0019085*x(:,3).*x(:,4) - 25) <= 0;
g6valid = (-9.300961 - 0.0047026*x(:,3).*x(:,5) - 0.0012547*x(:,1).*x(:,3) - 0.0019085*x(:,3).*x(:,4) + 20) <= 0;

valid = valid & g1valid & g2valid & g3valid & g4valid & g5valid & g6valid;

end
